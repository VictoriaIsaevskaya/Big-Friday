"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8895],{8895:(S,m,c)=>{c.r(m),c.d(m,{EventDetailsPageModule:()=>O});var g=c(6814),y=c(6223),l=c(8857),s=c(7311),_=c(2884),t=c(5879);let U=(()=>{class o{constructor(n){this.modalCtrl=n}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(s.IN))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-auth-prompt"]],standalone:!0,features:[t.jDz],decls:15,vars:0,consts:[[1,"form-content"],["no-border",""],["slot","start"],["fill","clear",3,"click"],["name","close-outline","color","light"],[1,"auth-modal-container"],[1,"intro-text"],["expand","block","routerLink","/auth/login",1,"single-btn","align-block-center",3,"click"],["expand","block","fill","outline","color","primary","routerLink","/auth/signup",1,"single-btn","align-block-center",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"ion-content",0)(1,"ion-header",1)(2,"ion-toolbar")(3,"ion-buttons",2)(4,"ion-button",3),t.NdJ("click",function(){return i.modalCtrl.dismiss()}),t._UZ(5,"ion-icon",4),t.qZA()(),t.TgZ(6,"ion-title"),t._uU(7,"Authentication Needed"),t.qZA()()(),t.TgZ(8,"ion-content",5)(9,"p",6),t._uU(10," To join the event, you need to be authenticated. "),t.qZA(),t.TgZ(11,"ion-button",7),t.NdJ("click",function(){return i.modalCtrl.dismiss()}),t._uU(12,"Login"),t.qZA(),t.TgZ(13,"ion-button",8),t.NdJ("click",function(){return i.modalCtrl.dismiss()}),t._uU(14,"Sign Up"),t.qZA()()())},dependencies:[l.Bz,l.rH,s.Pc,s.YG,s.Sm,s.W2,s.Gu,s.gu,s.wd,s.sr,s.YI,g.ez],styles:[".auth-modal-toolbar[_ngcontent-%COMP%]{--background: transparent}.auth-modal-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%}.intro-text[_ngcontent-%COMP%]{color:var(--ion-color-light);text-align:center;margin-bottom:20px}"]}),o})();var E=c(5861),b=c(7582),A=c(1993),v=c(4666),Z=c(9397),x=c(5062),p=c(9207),h=c(7140),T=c(2333),C=c(3926);function P(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"ion-button",20),t.NdJ("click",function(){t.CHM(n);const r=t.oxw().ngIf,a=t.oxw();return t.KtG(a.joinEvent(r.id,r.chatId))}),t._uU(1,"Join"),t.qZA()}}function M(o,e){1&o&&(t.TgZ(0,"ion-button",21),t._uU(1,"Sign Up to Join"),t.qZA())}function k(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"ion-button",22),t.NdJ("click",function(){t.CHM(n);const r=t.oxw().ngIf,a=t.oxw();return t.KtG(a.leaveEvent(r.id))}),t._uU(1,"Leave"),t.qZA()}}function I(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"ion-button",22),t.NdJ("click",function(){t.CHM(n);const r=t.oxw().ngIf,a=t.oxw();return t.KtG(a.deleteEvent(r.id))}),t._uU(1,"Delete"),t.qZA()}}function D(o,e){if(1&o&&(t.ynx(0),t._UZ(1,"app-page-header",1),t.TgZ(2,"ion-content",2)(3,"ion-card",3)(4,"ion-card-content")(5,"ion-card-title",4),t._uU(6),t.qZA(),t.TgZ(7,"p",5),t._uU(8),t.qZA(),t.TgZ(9,"div",6)(10,"div"),t._UZ(11,"ion-icon",7),t._uU(12),t.ALo(13,"date"),t.ALo(14,"date"),t.qZA(),t.TgZ(15,"div"),t._UZ(16,"ion-icon",8),t._uU(17),t.qZA(),t.TgZ(18,"div"),t._UZ(19,"ion-icon",9),t._uU(20),t.qZA(),t.TgZ(21,"div"),t._UZ(22,"ion-icon",10),t._uU(23),t.qZA(),t.TgZ(24,"div"),t._UZ(25,"ion-icon",11),t._uU(26),t.qZA(),t.TgZ(27,"div"),t._UZ(28,"ion-icon",12),t._uU(29),t.qZA(),t.TgZ(30,"div",13)(31,"h4"),t._uU(32,"Event Rules:"),t.qZA(),t._uU(33),t.qZA(),t.TgZ(34,"div",14)(35,"h4"),t._uU(36,"Additional Information:"),t.qZA(),t._uU(37),t.qZA()(),t.TgZ(38,"div",15)(39,"p")(40,"strong"),t._uU(41,"Organized by:"),t.qZA(),t._uU(42),t.qZA(),t.TgZ(43,"ion-avatar"),t._UZ(44,"img",16),t.qZA()(),t.YNc(45,P,2,0,"ion-button",17),t.YNc(46,M,2,0,"ion-button",18),t.YNc(47,k,2,0,"ion-button",19),t.YNc(48,I,2,0,"ion-button",19),t.qZA()()(),t.BQk()),2&o){const n=e.ngIf,i=t.oxw();let r;t.xp6(1),t.Q6J("pageTitle",n.title),t.xp6(5),t.Oqu(n.title),t.xp6(2),t.Oqu(n.description),t.xp6(4),t.AsE(" ",t.xi3(13,19,n.date,"mediumDate")," ",t.xi3(14,22,n.date,"shortTime"),""),t.xp6(5),t.hij(" ",n.location,""),t.xp6(3),t.AsE(" ",null!==(r=null==n.participants?null:n.participants.length)&&void 0!==r?r:0,"/",n.maxAttendees," participants"),t.xp6(3),t.hij(" ",n.eventCost,""),t.xp6(3),t.hij(" ",n.language,""),t.xp6(3),t.hij(" ",n.recommendedAgeGroup,""),t.xp6(4),t.hij(" ",n.rules," "),t.xp6(4),t.hij(" ",n.additionalInfo," "),t.xp6(5),t.hij(" ",i.isCurrentUserOrganizer()?"You":n.organizer.name,""),t.xp6(2),t.Q6J("src",n.organizer.avatar,t.LSH),t.xp6(1),t.Q6J("ngIf",i.currentUserUid&&!i.isCurrentUserOrganizer()&&!i.isCurrentUserJoined),t.xp6(1),t.Q6J("ngIf",!i.currentUserUid),t.xp6(1),t.Q6J("ngIf",!i.isCurrentUserOrganizer()&&i.isCurrentUserJoined),t.xp6(1),t.Q6J("ngIf",i.isCurrentUserOrganizer())}}class d{constructor(e,n,i,r,a,f){this.route=e,this.store=n,this.modalController=i,this.router=r,this.authService=a,this.firestoreApiService=f,this.destroyRef=(0,t.f3M)(t.ktI),this.store.dispatch(new p.Tc({eventId:this.route.snapshot.paramMap.get("eventId")})),this.event$.pipe((0,A.sL)(this.destroyRef),(0,Z.b)(u=>this.selectedEvent=u)).subscribe(),this.currentUserActivities$.pipe((0,A.sL)(this.destroyRef),(0,Z.b)(u=>this.currentUserActivities=u)).subscribe()}ngOnInit(){this.currentUserUid=this.authService.getCurrentUserId()}joinEvent(e,n){this.store.selectSnapshot(x.jq.isLoggedIn)&&this.joinUserToEvent(e,n)}joinUserToEvent(e,n){const{username:i,about:r,ageGroup:a,interests:f}=this.store.selectSnapshot(h.aF.userPreferences);this.selectedEvent.participants&&this.selectedEvent.participants.push({userId:this.currentUserUid,username:i,about:r,ageGroup:a,interests:f}),this.store.dispatch(new p.H1({eventId:e,eventData:{participants:this.selectedEvent.participants}})),this.currentUserActivities.joinedEvents?this.currentUserActivities.joinedEvents.push({eventId:e,chatId:n}):this.currentUserActivities.joinedEvents=[{eventId:e,chatId:n}],this.store.dispatch(new h.mm({userId:this.currentUserUid,events:this.currentUserActivities.joinedEvents})),this.firestoreApiService.addParticipantToChat(n,{userId:this.currentUserUid,unreadMessagesCount:0}),this.router.navigate(["chats",n])}openShouldAuthModal(){var e=this;return(0,E.Z)(function*(){return yield(yield e.modalController.create({component:U})).present()})()}leaveEvent(e){var n;const i=null===(n=this.selectedEvent.participants)||void 0===n?void 0:n.filter(r=>r.userId!==this.currentUserUid);this.store.dispatch(new h.mm({userId:this.currentUserUid,events:this.currentUserActivities.joinedEvents.filter(r=>e!==r.eventId)})),this.store.dispatch(new p.H1({eventId:e,eventData:{participants:i}}))}deleteEvent(e){this.store.dispatch(new p.A1({eventId:e}))}get isCurrentUserJoined(){var e;return!(null===(e=this.currentUserActivities)||void 0===e||null===(e=e.joinedEvents)||void 0===e||!e.find(n=>{var i;return n.eventId===(null===(i=this.selectedEvent)||void 0===i?void 0:i.id)}))}isCurrentUserOrganizer(){var e;return this.currentUserUid===(null===(e=this.selectedEvent.organizer)||void 0===e?void 0:e.uid)}}d.\u0275fac=function(e){return new(e||d)(t.Y36(l.gz),t.Y36(v.yh),t.Y36(s.IN),t.Y36(l.F0),t.Y36(T.e),t.Y36(C.P))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-event-details"]],decls:2,vars:3,consts:[[4,"ngIf"],["backRedirectionLink","/events",3,"pageTitle"],[1,"event-details-content"],[1,"activity-card"],[1,"title"],[1,"description"],[1,"secondary-color"],["name","calendar-outline"],["name","location-outline"],["name","people-outline"],["name","wallet-outline"],["name","language-outline"],["name","person-outline"],[1,"rules-section"],[1,"additional-info-section"],[1,"organizer-section"],["alt","Organizer's avatar",3,"src"],[3,"click",4,"ngIf"],["routerLink","/auth/signup",4,"ngIf"],["color","danger",3,"click",4,"ngIf"],[3,"click"],["routerLink","/auth/signup"],["color","danger",3,"click"]],template:function(e,n){1&e&&(t.YNc(0,D,49,25,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.event$))},dependencies:[g.O5,s.BJ,s.YG,s.PM,s.FN,s.Dq,s.W2,s.gu,s.YI,l.rH,_.q,g.Ov,g.uU],styles:["[_ngcontent-%COMP%]:root{--ion-background-color: #e0e0e0;--ion-color-primary: #a17d63;--ion-text-color-primary: #4b2e36;--ion-text-color-secondary: #7d402e;--ion-color-primary-rgb: 56, 128, 255;--ion-color-primary-contrast: ghostwhite;--ion-color-primary-contrast-rgb: 255, 255, 255;--ion-color-primary-shade: #3171e0;--ion-color-primary-tint: #4c8dff;--ion-color-secondary: #3dc2ff;--ion-color-secondary-rgb: 61, 194, 255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255, 255, 255;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #5260ff;--ion-color-tertiary-rgb: 82, 96, 255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255, 255, 255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45, 211, 111;--ion-color-success-contrast: #ffffff;--ion-color-success-contrast-rgb: 255, 255, 255;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255, 196, 9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0, 0, 0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235, 68, 90;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255, 255, 255;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-dark: #222428;--ion-color-dark-rgb: 34, 36, 40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255, 255, 255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146, 148, 156;--ion-color-medium-contrast: #ffffff;--ion-color-medium-contrast-rgb: 255, 255, 255;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244, 245, 248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0, 0, 0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9}@media (prefers-color-scheme: dark){body[_ngcontent-%COMP%]{color-scheme:light}}.event-details-content[_ngcontent-%COMP%]{background-color:var(--ion-color-dark)}.activity-card[_ngcontent-%COMP%]{margin:16px}.activity-card[_ngcontent-%COMP%]   .organizer-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:24px}"],changeDetection:0}),(0,b.gn)([(0,v.Ph)(p.nF.selectedEventDetails)],d.prototype,"event$",void 0),(0,b.gn)([(0,v.Ph)(h.aF.userActivities)],d.prototype,"currentUserActivities$",void 0);const j=[{path:"",component:d}];let J=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[l.Bz.forChild(j),l.Bz]}),o})(),O=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.ez,y.u5,s.Pc,J,_.q,U,l.Bz]}),o})()}}]);